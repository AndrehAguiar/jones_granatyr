SET GLOBAL log_bin_trust_function_creators = 1;

delimiter $$
create function GetDiaSemana(data_pedido date) returns varchar(10)
begin
	return dayname(data_pedido);
end $$
delimiter ;

select data_pedido, GetDiaSemana(data_pedido) from pedidos;


delimiter $$
create function GetPeriodoVenda(hora_pedido time) returns varchar(10)
begin
	declare periodo varchar(10);
    if (hora_pedido < '20:00:00') then
		set periodo = 'Inicio';
	elseif (hora_pedido >= '20:00:00' and hora_pedido < '22:00:00') then
		set periodo = 'Pico';
	elseif (hora_pedido >= '22:00:00') then
		set periodo = 'Final';
	end if;
    return periodo;
end $$
delimiter ;

select hora_pedido, GetPeriodoVenda(hora_pedido) from pedidos;